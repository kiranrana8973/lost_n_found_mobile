<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Lost &amp; Found Mobile Application - Technical Documentation</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        max-width: 900px;
        margin: 0 auto;
        padding: 40px;
        line-height: 1.6;
        color: #333;
      }
      h1 {
        color: #1a5276;
        border-bottom: 3px solid #3498db;
        padding-bottom: 10px;
        page-break-before: always;
      }
      h1:first-of-type {
        page-break-before: avoid;
      }
      h2 {
        color: #2874a6;
        border-bottom: 2px solid #85c1e9;
        padding-bottom: 5px;
        margin-top: 30px;
      }
      h3 {
        color: #1f618d;
        margin-top: 25px;
      }
      h4 {
        color: #2e86ab;
      }
      table {
        border-collapse: collapse;
        width: 100%;
        margin: 15px 0;
      }
      th,
      td {
        border: 1px solid #ddd;
        padding: 10px;
        text-align: left;
      }
      th {
        background-color: #3498db;
        color: white;
      }
      tr:nth-child(even) {
        background-color: #f8f9fa;
      }
      pre,
      code {
        background-color: #f4f4f4;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-family: "Consolas", "Courier New", monospace;
        font-size: 13px;
      }
      pre {
        padding: 15px;
        overflow-x: auto;
        white-space: pre-wrap;
      }
      code {
        padding: 2px 6px;
      }
      .toc {
        background-color: #f8f9fa;
        border: 1px solid #ddd;
        padding: 20px;
        margin: 20px 0;
      }
      .toc h2 {
        margin-top: 0;
        border-bottom: none;
      }
      .toc ul {
        list-style-type: none;
        padding-left: 20px;
      }
      .toc li {
        margin: 8px 0;
      }
      .toc a {
        color: #2874a6;
        text-decoration: none;
      }
      .toc a:hover {
        text-decoration: underline;
      }
      .diagram {
        background-color: #f8f9fa;
        border: 1px solid #ddd;
        padding: 15px;
        font-family: "Consolas", monospace;
        white-space: pre;
        overflow-x: auto;
      }
      .highlight {
        background-color: #fff3cd;
        padding: 15px;
        border-left: 4px solid #ffc107;
        margin: 15px 0;
      }
      .cover-page {
        text-align: center;
        padding: 100px 0;
        page-break-after: always;
      }
      .cover-page h1 {
        font-size: 36px;
        border-bottom: none;
      }
      .cover-page .subtitle {
        font-size: 24px;
        color: #666;
        margin-top: 20px;
      }
      .cover-page .info {
        margin-top: 50px;
        color: #888;
      }
    </style>
  </head>
  <body>
    <div class="cover-page">
      <h1>Lost &amp; Found Mobile Application</h1>
      <div class="subtitle">Complete Technical Documentation</div>
      <div class="info">
        <p><strong>Version:</strong> 1.0</p>
        <p><strong>Date:</strong> January 2025</p>
        <p><strong>Technology:</strong> Flutter / Dart</p>
        <p><strong>Architecture:</strong> Clean Architecture</p>
      </div>
    </div>

    <div class="toc">
      <h2>Table of Contents</h2>
      <ul>
        <li><a href="#overview">1. Project Overview</a></li>
        <li><a href="#architecture">2. Clean Architecture</a></li>
        <li><a href="#structure">3. Project Structure</a></li>
        <li><a href="#hive">4. Hive Database</a></li>
        <li><a href="#dio">5. Dio API Client</a></li>
        <li><a href="#features">6. Features</a></li>
        <li><a href="#state">7. State Management</a></li>
        <li><a href="#models">8. Data Models</a></li>
        <li><a href="#flow">9. Application Flow</a></li>
        <li><a href="#endpoints">10. API Endpoints</a></li>
        <li><a href="#dependencies">11. Dependencies</a></li>
      </ul>
    </div>

    <h1 id="overview">1. Project Overview</h1>

    <h2>1.1 Introduction</h2>
    <p>
      The <strong>Lost &amp; Found Mobile Application</strong> is a
      Flutter-based mobile application designed to help users report and
      discover lost or found items within a community or organization. The app
      follows modern software development practices including Clean
      Architecture, offline-first design, and reactive state management.
    </p>

    <h2>1.2 Key Features</h2>
    <table>
      <tr>
        <th>Feature</th>
        <th>Description</th>
      </tr>
      <tr>
        <td><strong>User Authentication</strong></td>
        <td>
          Secure login and registration with JWT token-based authentication
        </td>
      </tr>
      <tr>
        <td><strong>Report Lost Items</strong></td>
        <td>Users can report items they have lost with photos/videos</td>
      </tr>
      <tr>
        <td><strong>Report Found Items</strong></td>
        <td>Users can report items they have found</td>
      </tr>
      <tr>
        <td><strong>Search &amp; Filter</strong></td>
        <td>Full-text search and category-based filtering</td>
      </tr>
      <tr>
        <td><strong>Media Upload</strong></td>
        <td>Support for photo and video uploads</td>
      </tr>
      <tr>
        <td><strong>Offline Support</strong></td>
        <td>Local caching with Hive database for offline access</td>
      </tr>
      <tr>
        <td><strong>Claim Items</strong></td>
        <td>Users can claim items that belong to them</td>
      </tr>
      <tr>
        <td><strong>User Profiles</strong></td>
        <td>Personal profiles with batch/group association</td>
      </tr>
    </table>

    <h2>1.3 Technology Stack</h2>
    <table>
      <tr>
        <th>Component</th>
        <th>Technology</th>
      </tr>
      <tr>
        <td><strong>Framework</strong></td>
        <td>Flutter 3.x</td>
      </tr>
      <tr>
        <td><strong>Language</strong></td>
        <td>Dart</td>
      </tr>
      <tr>
        <td><strong>State Management</strong></td>
        <td>Riverpod</td>
      </tr>
      <tr>
        <td><strong>Local Database</strong></td>
        <td>Hive</td>
      </tr>
      <tr>
        <td><strong>HTTP Client</strong></td>
        <td>Dio</td>
      </tr>
      <tr>
        <td><strong>Architecture</strong></td>
        <td>Clean Architecture</td>
      </tr>
    </table>

    <h1 id="architecture">2. Clean Architecture</h1>

    <h2>2.1 Overview</h2>
    <p>
      Clean Architecture is a software design philosophy that separates the
      codebase into distinct layers, each with specific responsibilities. This
      separation ensures:
    </p>
    <ul>
      <li>
        <strong>Testability:</strong> Each layer can be tested independently
      </li>
      <li>
        <strong>Maintainability:</strong> Changes in one layer don't affect
        others
      </li>
      <li>
        <strong>Scalability:</strong> Easy to add new features without modifying
        existing code
      </li>
      <li>
        <strong>Independence:</strong> Business logic is independent of UI and
        external frameworks
      </li>
    </ul>

    <h2>2.2 Architecture Layers</h2>
    <p>The application is divided into three main layers:</p>

    <div class="diagram">
      +-------------------------------------------------------------+ |
      PRESENTATION LAYER | | (Pages, Widgets, ViewModels, State Management) |
      +-------------------------------------------------------------+ | DOMAIN
      LAYER | | (Entities, Repository Interfaces, Use Cases) |
      +-------------------------------------------------------------+ | DATA
      LAYER | | (Models, Data Sources, Repository Implementations) |
      +-------------------------------------------------------------+
    </div>

    <h3>2.2.1 Presentation Layer</h3>
    <p>
      <strong>Purpose:</strong> Handles all UI-related concerns and user
      interactions.
    </p>
    <p><strong>Components:</strong></p>
    <ul>
      <li>
        <strong>Pages/Screens:</strong> Full-page widgets (LoginPage,
        DashboardPage, etc.)
      </li>
      <li>
        <strong>Widgets:</strong> Reusable UI components (ItemCard, SearchBar,
        etc.)
      </li>
      <li>
        <strong>ViewModels:</strong> State management classes using Riverpod
        NotifierProvider
      </li>
      <li>
        <strong>State Classes:</strong> Immutable state objects with status
        tracking
      </li>
    </ul>

    <h3>2.2.2 Domain Layer</h3>
    <p>
      <strong>Purpose:</strong> Contains business logic and is independent of
      any external frameworks.
    </p>
    <p><strong>Components:</strong></p>
    <ul>
      <li>
        <strong>Entities:</strong> Pure business objects representing core data
      </li>
      <li>
        <strong>Repository Interfaces:</strong> Abstract contracts defining data
        operations
      </li>
      <li>
        <strong>Use Cases:</strong> Single-responsibility classes executing
        business logic
      </li>
    </ul>

    <h3>2.2.3 Data Layer</h3>
    <p>
      <strong>Purpose:</strong> Handles data retrieval and storage from various
      sources.
    </p>
    <p><strong>Components:</strong></p>
    <ul>
      <li>
        <strong>Models:</strong> Data transfer objects with serialization logic
        <ul>
          <li>
            API Models: <code>fromJson()</code> / <code>toJson()</code> for API
            communication
          </li>
          <li>
            Hive Models: <code>@HiveType</code> annotated classes for local
            storage
          </li>
        </ul>
      </li>
      <li>
        <strong>Data Sources:</strong>
        <ul>
          <li>Remote: API calls using Dio</li>
          <li>Local: Hive database operations</li>
        </ul>
      </li>
      <li>
        <strong>Repository Implementations:</strong> Concrete implementations of
        domain interfaces
      </li>
    </ul>

    <h2>2.3 Data Flow Diagram</h2>
    <div class="diagram">
      +----------+ +-----------+ +---------+ +------------+ +-------------+ | UI
      |---&gt;| ViewModel |---&gt;| UseCase |---&gt;| Repository |---&gt;|
      DataSource | | (Page) | | (State) | | | | | | (API/Hive) | +----------+
      +-----------+ +---------+ +------------+ +-------------+ ^ | | |
      +--------------------------------------------------------------------+
      (Response flows back)
    </div>

    <h1 id="structure">3. Project Structure</h1>

    <h2>3.1 Directory Layout</h2>
    <pre>
lib/
├── app/                              # Application Configuration
│   ├── app.dart                      # Main App widget
│   ├── routes/                       # Navigation routing
│   │   └── app_routes.dart
│   └── theme/                        # Theme configuration
│       └── app_theme.dart
│
├── core/                             # Core Functionality (Shared)
│   ├── api/                          # HTTP Client
│   │   ├── api_client.dart           # Dio client setup
│   │   ├── api_endpoints.dart        # API URL constants
│   │   └── interceptors/             # Request/Response interceptors
│   │       ├── auth_interceptor.dart
│   │       └── retry_interceptor.dart
│   │
│   ├── constants/                    # App-wide constants
│   ├── error/                        # Error handling
│   │   ├── exceptions.dart           # Custom exceptions
│   │   └── failures.dart             # Failure classes
│   │
│   ├── services/                     # Core Services
│   │   ├── connectivity/             # Network detection
│   │   │   └── network_info.dart
│   │   ├── hive/                     # Local database
│   │   │   └── hive_service.dart
│   │   ├── media/                    # Media handling
│   │   └── storage/                  # Secure storage
│   │       ├── token_service.dart
│   │       └── user_session_service.dart
│   │
│   ├── usecases/                     # Base use case class
│   ├── utils/                        # Utility functions
│   └── widgets/                      # Reusable widgets
│
└── features/                         # Feature Modules
    ├── auth/                         # Authentication Feature
    │   ├── data/
    │   │   ├── datasources/
    │   │   ├── models/
    │   │   │   ├── auth_api_model.dart
    │   │   │   └── auth_hive_model.dart
    │   │   └── repositories/
    │   ├── domain/
    │   │   ├── entities/
    │   │   ├── repositories/
    │   │   └── usecases/
    │   └── presentation/
    │       ├── pages/
    │       ├── viewmodel/
    │       └── widgets/
    │
    ├── batch/                        # Batch Management Feature
    ├── category/                     # Category Feature
    ├── dashboard/                    # Dashboard Feature
    ├── item/                         # Item Management Feature
    ├── onboarding/                   # Onboarding Feature
    └── splash/                       # Splash Screen Feature
</pre
    >

    <h1 id="hive">4. Hive Database</h1>

    <h2>4.1 Introduction to Hive</h2>
    <p>
      Hive is a lightweight and blazing-fast key-value database written in pure
      Dart. It is used in this application for:
    </p>
    <ul>
      <li>
        <strong>Offline Support:</strong> Caching API responses for offline
        access
      </li>
      <li><strong>Local Storage:</strong> Storing user data locally</li>
      <li><strong>Performance:</strong> Fast read/write operations</li>
      <li>
        <strong>Type Safety:</strong> Strongly typed data models with adapters
      </li>
    </ul>

    <h2>4.2 Database Configuration</h2>

    <h3>4.2.1 Initialization</h3>
    <p>
      The Hive database is initialized in <code>main.dart</code> before the app
      starts:
    </p>
    <pre>
// main.dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();

  // Initialize Hive
  await HiveService.instance.init();

  // Initialize SharedPreferences
  final prefs = await SharedPreferences.getInstance();

  runApp(
    ProviderScope(
      overrides: [
        sharedPreferencesProvider.overrideWithValue(prefs),
      ],
      child: const MyApp(),
    ),
  );
}
</pre
    >

    <h3>4.2.2 HiveService Implementation</h3>
    <pre>
class HiveService {
  static final HiveService _instance = HiveService._internal();
  static HiveService get instance => _instance;

  HiveService._internal();

  // Box references
  late Box&lt;BatchHiveModel&gt; _batchBox;
  late Box&lt;AuthHiveModel&gt; _studentBox;
  late Box&lt;ItemHiveModel&gt; _itemBox;
  late Box&lt;CategoryHiveModel&gt; _categoryBox;

  // Initialization
  Future&lt;void&gt; init() async {
    final appDocumentDir = await getApplicationDocumentsDirectory();
    await Hive.initFlutter(appDocumentDir.path);

    // Register adapters
    _registerAdapters();

    // Open boxes
    await _openBoxes();
  }

  void _registerAdapters() {
    Hive.registerAdapter(BatchHiveModelAdapter());    // TypeId: 0
    Hive.registerAdapter(AuthHiveModelAdapter());     // TypeId: 1
    Hive.registerAdapter(ItemHiveModelAdapter());     // TypeId: 2
    Hive.registerAdapter(CategoryHiveModelAdapter()); // TypeId: 3
  }

  Future&lt;void&gt; _openBoxes() async {
    _batchBox = await Hive.openBox&lt;BatchHiveModel&gt;('batch_table');
    _studentBox = await Hive.openBox&lt;AuthHiveModel&gt;('student_table');
    _itemBox = await Hive.openBox&lt;ItemHiveModel&gt;('item_table');
    _categoryBox = await Hive.openBox&lt;CategoryHiveModel&gt;('category_table');
  }
}
</pre
    >

    <h2>4.3 Hive Models</h2>

    <h3>4.3.1 Model Overview</h3>
    <table>
      <tr>
        <th>Model</th>
        <th>Type ID</th>
        <th>Box Name</th>
        <th>Purpose</th>
      </tr>
      <tr>
        <td><code>BatchHiveModel</code></td>
        <td>0</td>
        <td>batch_table</td>
        <td>Store batch/group information</td>
      </tr>
      <tr>
        <td><code>AuthHiveModel</code></td>
        <td>1</td>
        <td>student_table</td>
        <td>Store user/student data</td>
      </tr>
      <tr>
        <td><code>ItemHiveModel</code></td>
        <td>2</td>
        <td>item_table</td>
        <td>Store lost/found items</td>
      </tr>
      <tr>
        <td><code>CategoryHiveModel</code></td>
        <td>3</td>
        <td>category_table</td>
        <td>Store item categories</td>
      </tr>
    </table>

    <h3>4.3.2 BatchHiveModel</h3>
    <pre>
@HiveType(typeId: 0)
class BatchHiveModel extends HiveObject {
  @HiveField(0)
  final String? batchId;

  @HiveField(1)
  final String? batchName;

  @HiveField(2)
  final String? status;

  BatchHiveModel({
    this.batchId,
    this.batchName,
    this.status,
  });

  BatchEntity toEntity() {
    return BatchEntity(
      id: batchId,
      batchName: batchName,
      status: status,
    );
  }
}
</pre
    >

    <h3>4.3.3 AuthHiveModel</h3>
    <pre>
@HiveType(typeId: 1)
class AuthHiveModel extends HiveObject {
  @HiveField(0)
  final String? authId;

  @HiveField(1)
  final String? fullName;

  @HiveField(2)
  final String? email;

  @HiveField(3)
  final String? phoneNumber;

  @HiveField(4)
  final String? username;

  @HiveField(5)
  final String? password;

  @HiveField(6)
  final String? batchId;

  @HiveField(7)
  final String? profilePicture;
}
</pre
    >

    <h3>4.3.4 ItemHiveModel</h3>
    <pre>
@HiveType(typeId: 2)
class ItemHiveModel extends HiveObject {
  @HiveField(0)
  final String? itemId;

  @HiveField(1)
  final String? reportedBy;

  @HiveField(2)
  final String? claimedBy;

  @HiveField(3)
  final String? category;

  @HiveField(4)
  final String? itemName;

  @HiveField(5)
  final String? description;

  @HiveField(6)
  final String? type;  // 'lost' or 'found'

  @HiveField(7)
  final String? location;

  @HiveField(8)
  final String? media;

  @HiveField(9)
  final String? mediaType;

  @HiveField(10)
  final bool? isClaimed;

  @HiveField(11)
  final String? status;
}
</pre
    >

    <h3>4.3.5 CategoryHiveModel</h3>
    <pre>
@HiveType(typeId: 3)
class CategoryHiveModel extends HiveObject {
  @HiveField(0)
  final String? categoryId;

  @HiveField(1)
  final String? name;

  @HiveField(2)
  final String? description;

  @HiveField(3)
  final String? status;
}
</pre
    >

    <h2>4.4 Hive CRUD Operations</h2>
    <pre>
// CREATE
Future&lt;void&gt; createItem(ItemHiveModel item) async {
  await _itemBox.put(item.itemId, item);
}

// READ - Get All
Future&lt;List&lt;ItemEntity&gt;&gt; getAllItems() async {
  return _itemBox.values.map((model) =&gt; model.toEntity()).toList();
}

// READ - Get by ID
Future&lt;ItemEntity?&gt; getItemById(String id) async {
  final model = _itemBox.get(id);
  return model?.toEntity();
}

// READ - Get by Type
Future&lt;List&lt;ItemEntity&gt;&gt; getItemsByType(String type) async {
  return _itemBox.values
      .where((item) =&gt; item.type == type)
      .map((model) =&gt; model.toEntity())
      .toList();
}

// UPDATE
Future&lt;void&gt; updateItem(ItemHiveModel item) async {
  await _itemBox.put(item.itemId, item);
}

// DELETE
Future&lt;void&gt; deleteItem(String id) async {
  await _itemBox.delete(id);
}

// CACHE API RESPONSE
Future&lt;void&gt; cacheItems(List&lt;ItemEntity&gt; items) async {
  await _itemBox.clear();
  for (final item in items) {
    final hiveModel = ItemHiveModel.fromEntity(item);
    await _itemBox.put(hiveModel.itemId, hiveModel);
  }
}
</pre
    >

    <h1 id="dio">5. Dio API Client</h1>

    <h2>5.1 Introduction to Dio</h2>
    <p>Dio is a powerful HTTP client for Dart that supports:</p>
    <ul>
      <li>Global configuration</li>
      <li>Interceptors</li>
      <li>Request/Response transformation</li>
      <li>File uploading/downloading</li>
      <li>Timeout handling</li>
      <li>Error handling</li>
    </ul>

    <h2>5.2 API Client Configuration</h2>

    <h3>5.2.1 Base Configuration</h3>
    <pre>
class ApiClient {
  late final Dio _dio;

  ApiClient() {
    _dio = Dio(
      BaseOptions(
        baseUrl: ApiEndpoints.baseUrl,
        connectTimeout: const Duration(seconds: 30),
        receiveTimeout: const Duration(seconds: 30),
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json',
        },
      ),
    );

    _setupInterceptors();
  }

  void _setupInterceptors() {
    // Auth Interceptor
    _dio.interceptors.add(AuthInterceptor());

    // Retry Interceptor
    _dio.interceptors.add(
      RetryInterceptor(
        dio: _dio,
        retries: 3,
        retryDelays: [
          const Duration(seconds: 1),
          const Duration(seconds: 2),
          const Duration(seconds: 3),
        ],
      ),
    );

    // Logger (Debug only)
    if (kDebugMode) {
      _dio.interceptors.add(PrettyDioLogger());
    }
  }
}
</pre
    >

    <h3>5.2.2 API Endpoints Configuration</h3>
    <pre>
class ApiEndpoints {
  // Base URLs
  static const String serverUrl = 'http://localhost:3000';
  static const String baseUrl = '$serverUrl/api/v1';

  // Auth Endpoints
  static const String login = '/students/login';
  static const String register = '/students';
  static String student(String id) =&gt; '/students/$id';

  // Item Endpoints
  static const String items = '/items';
  static String item(String id) =&gt; '/items/$id';
  static String claimItem(String id) =&gt; '/items/$id/claim';

  // Media Endpoints
  static const String uploadPhoto = '/items/upload-photo';
  static const String uploadVideo = '/items/upload-video';

  // Category Endpoints
  static const String categories = '/categories';
  static String category(String id) =&gt; '/categories/$id';

  // Batch Endpoints
  static const String batches = '/batches';
  static String batch(String id) =&gt; '/batches/$id';

  // Media URLs
  static String profilePicture(String filename) =&gt;
      '$serverUrl/profile_pictures/$filename';
  static String itemPhoto(String filename) =&gt;
      '$serverUrl/item_photos/$filename';
  static String itemVideo(String filename) =&gt;
      '$serverUrl/item_videos/$filename';
}
</pre
    >

    <h2>5.3 Interceptors</h2>

    <h3>5.3.1 Authentication Interceptor</h3>
    <pre>
class AuthInterceptor extends Interceptor {
  final TokenService _tokenService = TokenService();

  // Public endpoints that don't need authentication
  final List&lt;String&gt; _publicEndpoints = [
    '/batches',
    '/categories',
    '/students/login',
    '/students',  // POST only (register)
  ];

  @override
  void onRequest(
    RequestOptions options,
    RequestInterceptorHandler handler,
  ) async {
    // Check if endpoint is public
    final isPublic = _publicEndpoints.any(
      (endpoint) =&gt; options.path.contains(endpoint),
    );

    if (!isPublic) {
      // Add authorization header
      final token = await _tokenService.getToken();
      if (token != null) {
        options.headers['Authorization'] = 'Bearer $token';
      }
    }

    handler.next(options);
  }

  @override
  void onError(DioException err, ErrorInterceptorHandler handler) async {
    if (err.response?.statusCode == 401) {
      // Token expired or invalid
      await _tokenService.removeToken();
    }
    handler.next(err);
  }
}
</pre
    >

    <h3>5.3.2 Retry Interceptor</h3>
    <pre>
// Using dio_smart_retry package
RetryInterceptor(
  dio: dio,
  retries: 3,
  retryDelays: const [
    Duration(seconds: 1),
    Duration(seconds: 2),
    Duration(seconds: 3),
  ],
  retryEvaluator: (error, attempt) {
    // Only retry on connection errors
    return error.type == DioExceptionType.connectionError ||
           error.type == DioExceptionType.connectionTimeout;
  },
)
</pre
    >

    <h2>5.4 HTTP Methods</h2>

    <h3>5.4.1 GET Request</h3>
    <pre>
Future&lt;Response&gt; get(
  String endpoint, {
  Map&lt;String, dynamic&gt;? queryParameters,
}) async {
  try {
    final response = await _dio.get(
      endpoint,
      queryParameters: queryParameters,
    );
    return response;
  } on DioException catch (e) {
    throw _handleError(e);
  }
}

// Usage
final response = await apiClient.get(ApiEndpoints.items);
</pre
    >

    <h3>5.4.2 POST Request</h3>
    <pre>
Future&lt;Response&gt; post(
  String endpoint, {
  dynamic data,
}) async {
  try {
    final response = await _dio.post(endpoint, data: data);
    return response;
  } on DioException catch (e) {
    throw _handleError(e);
  }
}

// Usage
final response = await apiClient.post(
  ApiEndpoints.items,
  data: {
    'itemName': 'Lost Wallet',
    'description': 'Black leather wallet',
    'type': 'lost',
    'location': 'Library',
  },
);
</pre
    >

    <h3>5.4.3 File Upload</h3>
    <pre>
Future&lt;Response&gt; uploadFile(
  String endpoint, {
  required File file,
  required String fieldName,
}) async {
  try {
    final fileName = file.path.split('/').last;
    final formData = FormData.fromMap({
      fieldName: await MultipartFile.fromFile(
        file.path,
        filename: fileName,
      ),
    });

    final response = await _dio.post(
      endpoint,
      data: formData,
      options: Options(contentType: 'multipart/form-data'),
    );
    return response;
  } on DioException catch (e) {
    throw _handleError(e);
  }
}

// Usage
final response = await apiClient.uploadFile(
  ApiEndpoints.uploadPhoto,
  file: imageFile,
  fieldName: 'photo',
);
</pre
    >

    <h2>5.5 Error Handling</h2>
    <pre>
Exception _handleError(DioException error) {
  switch (error.type) {
    case DioExceptionType.connectionTimeout:
    case DioExceptionType.sendTimeout:
    case DioExceptionType.receiveTimeout:
      return TimeoutException('Connection timed out');

    case DioExceptionType.connectionError:
      return NetworkException('No internet connection');

    case DioExceptionType.badResponse:
      final statusCode = error.response?.statusCode;
      switch (statusCode) {
        case 400:
          return BadRequestException('Bad request');
        case 401:
          return UnauthorizedException('Please login again');
        case 403:
          return ForbiddenException('Access denied');
        case 404:
          return NotFoundException('Resource not found');
        case 500:
          return ServerException('Server error');
        default:
          return ApiException('Unknown error');
      }

    default:
      return ApiException('Something went wrong');
  }
}
</pre
    >

    <h1 id="features">6. Features</h1>

    <h2>6.1 Authentication Feature</h2>

    <h3>6.1.1 Overview</h3>
    <p>
      The authentication feature handles user registration, login, and session
      management.
    </p>

    <h3>6.1.2 Components</h3>
    <p><strong>Screens:</strong></p>
    <ul>
      <li><code>LoginPage</code>: Email/password login with validation</li>
      <li><code>SignupPage</code>: User registration with batch selection</li>
    </ul>

    <p><strong>Use Cases:</strong></p>
    <ul>
      <li><code>LoginUsecase</code>: Authenticates user credentials</li>
      <li><code>RegisterUsecase</code>: Creates new user account</li>
      <li><code>GetCurrentUserUsecase</code>: Retrieves logged-in user</li>
      <li><code>LogoutUsecase</code>: Clears session and token</li>
    </ul>

    <h3>6.1.3 Login Flow</h3>
    <div class="diagram">
      User enters credentials → Validate input → API call to /students/login →
      Receive JWT token → Save token (TokenService) → Save user session →
      Navigate to Dashboard
    </div>

    <h2>6.2 Item Management Feature</h2>

    <h3>6.2.1 Overview</h3>
    <p>The core feature for reporting and discovering lost/found items.</p>

    <h3>6.2.2 Components</h3>
    <p><strong>Screens:</strong></p>
    <ul>
      <li><code>ReportItemPage</code>: Form to report lost/found items</li>
      <li><code>ItemDetailPage</code>: View full item details</li>
      <li><code>MyItemsPage</code>: User's reported items</li>
    </ul>

    <p><strong>Use Cases:</strong></p>
    <ul>
      <li><code>GetAllItemsUsecase</code>: Fetch all items</li>
      <li><code>GetItemsByUserUsecase</code>: Fetch user's items</li>
      <li><code>CreateItemUsecase</code>: Report new item</li>
      <li><code>UpdateItemUsecase</code>: Update item details</li>
      <li><code>DeleteItemUsecase</code>: Remove item</li>
      <li><code>ClaimItemUsecase</code>: Claim an item</li>
      <li><code>UploadPhotoUsecase</code>: Upload item photo</li>
    </ul>

    <h3>6.2.3 Report Item Flow</h3>
    <ol>
      <li>User taps FAB on Dashboard</li>
      <li>Navigate to ReportItemPage</li>
      <li>Select item type (Lost/Found)</li>
      <li>Fill form: Item name, Description, Category, Location</li>
      <li>Optionally add photo/video</li>
      <li>Submit form</li>
      <li>API creates item</li>
      <li>Navigate back to Dashboard</li>
      <li>Item appears in list</li>
    </ol>

    <h2>6.3 Dashboard Feature</h2>

    <h3>6.3.1 Overview</h3>
    <p>
      The main navigation hub with bottom navigation and floating action button.
    </p>

    <h3>6.3.2 Structure</h3>
    <table>
      <tr>
        <th>Tab</th>
        <th>Screen</th>
        <th>Purpose</th>
      </tr>
      <tr>
        <td>Home</td>
        <td>HomeScreen</td>
        <td>Browse all items with search &amp; filters</td>
      </tr>
      <tr>
        <td>My Items</td>
        <td>MyItemsPage</td>
        <td>User's reported items</td>
      </tr>
      <tr>
        <td>Alerts</td>
        <td>AlertsScreen</td>
        <td>Notifications</td>
      </tr>
      <tr>
        <td>Profile</td>
        <td>ProfileScreen</td>
        <td>User settings</td>
      </tr>
    </table>

    <h3>6.3.3 Home Screen Features</h3>
    <ul>
      <li><strong>Search Bar:</strong> Full-text search on items</li>
      <li><strong>Statistics:</strong> Count of lost/found items</li>
      <li><strong>Filter Tabs:</strong> All / Lost / Found</li>
      <li><strong>Item Grid/List:</strong> Display items with cards</li>
      <li><strong>Pull to Refresh:</strong> Refresh item list</li>
    </ul>

    <h2>6.4 Category Feature</h2>
    <p>Manages item categories for better organization.</p>
    <table>
      <tr>
        <th>Category</th>
        <th>Description</th>
      </tr>
      <tr>
        <td>Electronics</td>
        <td>Phones, laptops, chargers</td>
      </tr>
      <tr>
        <td>Documents</td>
        <td>IDs, cards, certificates</td>
      </tr>
      <tr>
        <td>Accessories</td>
        <td>Watches, jewelry, bags</td>
      </tr>
      <tr>
        <td>Clothing</td>
        <td>Jackets, shoes, hats</td>
      </tr>
      <tr>
        <td>Books</td>
        <td>Textbooks, notebooks</td>
      </tr>
      <tr>
        <td>Keys</td>
        <td>Car keys, house keys</td>
      </tr>
      <tr>
        <td>Others</td>
        <td>Miscellaneous items</td>
      </tr>
    </table>

    <h1 id="state">7. State Management</h1>

    <h2>7.1 Riverpod Overview</h2>
    <p>The application uses <strong>Riverpod</strong> for state management:</p>
    <ul>
      <li><code>NotifierProvider</code> for stateful logic</li>
      <li>State classes for immutable state representation</li>
      <li>
        <code>ref.watch()</code> and <code>ref.read()</code> for state access
      </li>
    </ul>

    <h2>7.2 State Pattern</h2>

    <h3>7.2.1 State Class Structure</h3>
    <pre>
enum ItemStatus {
  initial,
  loading,
  loaded,
  error,
  created,
  updated,
  deleted,
}

class ItemState extends Equatable {
  final ItemStatus status;
  final List&lt;ItemEntity&gt; items;
  final List&lt;ItemEntity&gt; myItems;
  final List&lt;ItemEntity&gt; lostItems;
  final List&lt;ItemEntity&gt; foundItems;
  final ItemEntity? selectedItem;
  final String? errorMessage;

  const ItemState({
    this.status = ItemStatus.initial,
    this.items = const [],
    this.myItems = const [],
    this.lostItems = const [],
    this.foundItems = const [],
    this.selectedItem,
    this.errorMessage,
  });

  ItemState copyWith({
    ItemStatus? status,
    List&lt;ItemEntity&gt;? items,
    String? errorMessage,
  }) {
    return ItemState(
      status: status ?? this.status,
      items: items ?? this.items,
      errorMessage: errorMessage ?? this.errorMessage,
    );
  }
}
</pre
    >

    <h3>7.2.2 ViewModel Structure</h3>
    <pre>
// Provider definition
final itemViewModelProvider = NotifierProvider&lt;ItemViewModel, ItemState&gt;(
  () =&gt; ItemViewModel(),
);

// ViewModel implementation
class ItemViewModel extends Notifier&lt;ItemState&gt; {
  late final GetAllItemsUsecase _getAllItemsUsecase;

  @override
  ItemState build() {
    _getAllItemsUsecase = ref.read(getAllItemsUsecaseProvider);
    return const ItemState();
  }

  Future&lt;void&gt; getAllItems() async {
    state = state.copyWith(status: ItemStatus.loading);

    final result = await _getAllItemsUsecase.call();

    result.fold(
      (failure) =&gt; state = state.copyWith(
        status: ItemStatus.error,
        errorMessage: failure.message,
      ),
      (items) =&gt; state = state.copyWith(
        status: ItemStatus.loaded,
        items: items,
      ),
    );
  }
}
</pre
    >

    <h2>7.3 Using State in UI</h2>
    <pre>
class HomeScreen extends ConsumerWidget {
  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final itemState = ref.watch(itemViewModelProvider);

    // Handle different states
    return switch (itemState.status) {
      ItemStatus.loading =&gt; const Center(
        child: CircularProgressIndicator(),
      ),
      ItemStatus.error =&gt; Center(
        child: Text(itemState.errorMessage ?? 'Error'),
      ),
      ItemStatus.loaded =&gt; ListView.builder(
        itemCount: itemState.items.length,
        itemBuilder: (context, index) {
          final item = itemState.items[index];
          return ItemCard(item: item);
        },
      ),
      _ =&gt; const SizedBox.shrink(),
    };
  }
}
</pre
    >

    <h1 id="models">8. Data Models</h1>

    <h2>8.1 Model Conversion Pattern</h2>
    <p>Each feature has two model types that convert to/from entities:</p>
    <div class="diagram">
      +-------------+ +----------+ +-------------+ | API Model | ------&gt; |
      Entity | &lt;------ | Hive Model | | (Remote) | | (Domain) | | (Local) |
      +-------------+ +----------+ +-------------+ fromJson() Pure Dart
      toEntity() toJson() Object fromEntity() toEntity()
    </div>

    <h2>8.2 ItemApiModel</h2>
    <pre>
class ItemApiModel {
  final String? id;
  final String? itemName;
  final String? description;
  final String? type;
  final String? location;
  final String? category;
  final String? reportedBy;
  final String? media;
  final String? mediaType;
  final bool? isClaimed;
  final String? status;
  final String? createdAt;

  factory ItemApiModel.fromJson(Map&lt;String, dynamic&gt; json) {
    return ItemApiModel(
      id: json['_id'] ?? json['id'],
      itemName: json['itemName'],
      description: json['description'],
      type: json['type'],
      location: json['location'],
      category: json['category'] is String
          ? json['category']
          : json['category']?['_id'],
      reportedBy: json['reportedBy'] is String
          ? json['reportedBy']
          : json['reportedBy']?['_id'],
      media: json['media'],
      mediaType: json['mediaType'],
      isClaimed: json['isClaimed'],
      status: json['status'],
      createdAt: json['createdAt'],
    );
  }

  Map&lt;String, dynamic&gt; toJson() {
    return {
      'itemName': itemName,
      'description': description,
      'type': type,
      'location': location,
      'category': category,
      'reportedBy': reportedBy,
      'media': media,
      'mediaType': mediaType,
    };
  }

  ItemEntity toEntity() {
    return ItemEntity(
      id: id,
      itemName: itemName,
      description: description,
      type: type,
      location: location,
      // ... other mappings
    );
  }
}
</pre
    >

    <h1 id="flow">9. Application Flow</h1>

    <h2>9.1 App Startup Flow</h2>
    <div class="diagram">
      +-------------------------------+ | main.dart | | 1. Initialize Flutter |
      | 2. Initialize Hive | | 3. Initialize SharedPrefs | | 4. Run App |
      +-------------------------------+ | v +-------------------------------+ |
      SplashPage | | 1. Show animated logo | | 2. Check login status | | 3.
      Navigate accordingly | +-------------------------------+ |
      +--------+--------+ | | v v +----------+ +-------------+ | LoginPage| |
      DashboardPage| +----------+ +-------------+
    </div>

    <h2>9.2 Authentication Flow</h2>
    <div class="diagram">
      User App API Storage | | | | | Enter credentials | | |
      |---------------------&gt;| | | | | | | | | POST /students/login | | |
      |----------------------&gt;| | | | | | | | { token, user } | | |
      |&lt;----------------------| | | | | | | | Save token | | |
      |---------------------------------------------&gt;| | | | | | | Save user
      session | | | |---------------------------------------------&gt;| | | | |
      | Navigate to Dashboard | | |&lt;---------------------| | |
    </div>

    <h2>9.3 Offline Flow</h2>
    <div class="highlight">
      <strong>Network Available:</strong>
      <ol>
        <li>Fetch from API</li>
        <li>Transform API Model → Entity</li>
        <li>Cache Entity → Hive Model → Hive Box</li>
        <li>Return Entity to UI</li>
      </ol>

      <strong>Network Unavailable:</strong>
      <ol>
        <li>Read from Hive Box</li>
        <li>Transform Hive Model → Entity</li>
        <li>Return Entity to UI</li>
        <li>Show offline indicator</li>
      </ol>
    </div>

    <h1 id="endpoints">10. API Endpoints</h1>

    <h2>10.1 Base Configuration</h2>
    <table>
      <tr>
        <th>Setting</th>
        <th>Value</th>
      </tr>
      <tr>
        <td>Base URL</td>
        <td><code>http://localhost:3000/api/v1</code></td>
      </tr>
      <tr>
        <td>Content-Type</td>
        <td><code>application/json</code></td>
      </tr>
      <tr>
        <td>Authentication</td>
        <td>Bearer Token (JWT)</td>
      </tr>
    </table>

    <h2>10.2 Authentication Endpoints</h2>
    <table>
      <tr>
        <th>Method</th>
        <th>Endpoint</th>
        <th>Description</th>
        <th>Auth</th>
      </tr>
      <tr>
        <td>POST</td>
        <td>/students</td>
        <td>Register new user</td>
        <td>No</td>
      </tr>
      <tr>
        <td>POST</td>
        <td>/students/login</td>
        <td>Login user</td>
        <td>No</td>
      </tr>
      <tr>
        <td>GET</td>
        <td>/students/{id}</td>
        <td>Get user by ID</td>
        <td>Yes</td>
      </tr>
    </table>

    <h2>10.3 Item Endpoints</h2>
    <table>
      <tr>
        <th>Method</th>
        <th>Endpoint</th>
        <th>Description</th>
        <th>Auth</th>
      </tr>
      <tr>
        <td>GET</td>
        <td>/items</td>
        <td>Get all items</td>
        <td>Yes</td>
      </tr>
      <tr>
        <td>GET</td>
        <td>/items/{id}</td>
        <td>Get item by ID</td>
        <td>Yes</td>
      </tr>
      <tr>
        <td>POST</td>
        <td>/items</td>
        <td>Create new item</td>
        <td>Yes</td>
      </tr>
      <tr>
        <td>PUT</td>
        <td>/items/{id}</td>
        <td>Update item</td>
        <td>Yes</td>
      </tr>
      <tr>
        <td>DELETE</td>
        <td>/items/{id}</td>
        <td>Delete item</td>
        <td>Yes</td>
      </tr>
      <tr>
        <td>POST</td>
        <td>/items/{id}/claim</td>
        <td>Claim item</td>
        <td>Yes</td>
      </tr>
    </table>

    <h2>10.4 Media Endpoints</h2>
    <table>
      <tr>
        <th>Method</th>
        <th>Endpoint</th>
        <th>Description</th>
        <th>Auth</th>
      </tr>
      <tr>
        <td>POST</td>
        <td>/items/upload-photo</td>
        <td>Upload item photo</td>
        <td>Yes</td>
      </tr>
      <tr>
        <td>POST</td>
        <td>/items/upload-video</td>
        <td>Upload item video</td>
        <td>Yes</td>
      </tr>
    </table>

    <h2>10.5 Category &amp; Batch Endpoints</h2>
    <table>
      <tr>
        <th>Method</th>
        <th>Endpoint</th>
        <th>Description</th>
        <th>Auth</th>
      </tr>
      <tr>
        <td>GET</td>
        <td>/categories</td>
        <td>Get all categories</td>
        <td>No</td>
      </tr>
      <tr>
        <td>GET</td>
        <td>/categories/{id}</td>
        <td>Get category by ID</td>
        <td>No</td>
      </tr>
      <tr>
        <td>GET</td>
        <td>/batches</td>
        <td>Get all batches</td>
        <td>No</td>
      </tr>
      <tr>
        <td>GET</td>
        <td>/batches/{id}</td>
        <td>Get batch by ID</td>
        <td>No</td>
      </tr>
    </table>

    <h2>10.6 Media URLs</h2>
    <table>
      <tr>
        <th>Resource</th>
        <th>URL Pattern</th>
      </tr>
      <tr>
        <td>Profile Pictures</td>
        <td><code>http://localhost:3000/profile_pictures/{filename}</code></td>
      </tr>
      <tr>
        <td>Item Photos</td>
        <td><code>http://localhost:3000/item_photos/{filename}</code></td>
      </tr>
      <tr>
        <td>Item Videos</td>
        <td><code>http://localhost:3000/item_videos/{filename}</code></td>
      </tr>
    </table>

    <h1 id="dependencies">11. Dependencies</h1>

    <h2>11.1 Core Dependencies</h2>
    <table>
      <tr>
        <th>Package</th>
        <th>Version</th>
        <th>Purpose</th>
      </tr>
      <tr>
        <td>flutter_riverpod</td>
        <td>^3.0.3</td>
        <td>State management with providers</td>
      </tr>
      <tr>
        <td>hive</td>
        <td>^2.2.3</td>
        <td>Local NoSQL database</td>
      </tr>
      <tr>
        <td>hive_flutter</td>
        <td>^1.1.0</td>
        <td>Flutter integration for Hive</td>
      </tr>
      <tr>
        <td>dio</td>
        <td>^5.4.1</td>
        <td>HTTP client for API calls</td>
      </tr>
      <tr>
        <td>dio_smart_retry</td>
        <td>^7.0.1</td>
        <td>Automatic retry on failures</td>
      </tr>
      <tr>
        <td>pretty_dio_logger</td>
        <td>^1.4.0</td>
        <td>Debug logging for API calls</td>
      </tr>
      <tr>
        <td>connectivity_plus</td>
        <td>^7.0.0</td>
        <td>Network connectivity detection</td>
      </tr>
      <tr>
        <td>flutter_secure_storage</td>
        <td>^10.0.0</td>
        <td>Secure token storage</td>
      </tr>
      <tr>
        <td>shared_preferences</td>
        <td>^2.5.4</td>
        <td>Simple key-value storage</td>
      </tr>
      <tr>
        <td>path_provider</td>
        <td>^2.1.2</td>
        <td>Access to device directories</td>
      </tr>
      <tr>
        <td>image_picker</td>
        <td>^1.0.7</td>
        <td>Camera/gallery image selection</td>
      </tr>
      <tr>
        <td>cached_network_image</td>
        <td>^3.4.1</td>
        <td>Image caching and loading</td>
      </tr>
      <tr>
        <td>dartz</td>
        <td>^0.10.1</td>
        <td>Functional programming (Either type)</td>
      </tr>
      <tr>
        <td>equatable</td>
        <td>^2.0.7</td>
        <td>Value equality for classes</td>
      </tr>
      <tr>
        <td>uuid</td>
        <td>^4.3.3</td>
        <td>Generate unique IDs</td>
      </tr>
    </table>

    <h2>11.2 Dev Dependencies</h2>
    <table>
      <tr>
        <th>Package</th>
        <th>Version</th>
        <th>Purpose</th>
      </tr>
      <tr>
        <td>build_runner</td>
        <td>^2.4.8</td>
        <td>Code generation runner</td>
      </tr>
      <tr>
        <td>hive_generator</td>
        <td>^2.0.1</td>
        <td>Generate Hive adapters</td>
      </tr>
      <tr>
        <td>flutter_lints</td>
        <td>^5.0.0</td>
        <td>Code linting rules</td>
      </tr>
    </table>

    <hr />

    <h1>Summary</h1>

    <p>
      The <strong>Lost &amp; Found Mobile Application</strong> is a
      well-architected Flutter application that demonstrates modern software
      development practices:
    </p>

    <ol>
      <li>
        <strong>Clean Architecture</strong> ensures separation of concerns and
        maintainability
      </li>
      <li>
        <strong>Hive Database</strong> provides fast, offline-capable local
        storage
      </li>
      <li>
        <strong>Dio HTTP Client</strong> handles all API communication with
        retry and auth support
      </li>
      <li>
        <strong>Riverpod State Management</strong> offers reactive and testable
        state handling
      </li>
      <li>
        <strong>Feature-First Structure</strong> organizes code by business
        domain
      </li>
    </ol>

    <p>The application successfully enables users to:</p>
    <ul>
      <li>Report lost or found items with photos/videos</li>
      <li>Search and discover items in their community</li>
      <li>Claim items that belong to them</li>
      <li>Work offline with cached data</li>
      <li>Securely authenticate and manage their profile</li>
    </ul>

    <hr />

    <p style="text-align: center; color: #888; margin-top: 50px">
      <strong>Document Version:</strong> 1.0<br />
      <strong>Last Updated:</strong> January 2025<br />
      <strong>Project:</strong> Lost &amp; Found Mobile Application
    </p>
  </body>
</html>
